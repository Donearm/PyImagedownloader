#!/usr/bin/env python2
# -*- coding: utf-8 -*-

import unittest
import shareapic
import lxml.html

class TestShareapic(unittest.TestCase):

    def setUp(self):
        self.basedir = '/mnt/documents/Maidens/Uploads/'
        self.url = 'http://www.shareapic.net/View-24384249-Satomi-Shigemori---Sexy-Asian-Bikini-Model.html'
        self.example_shpic_page = """<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" lang="en">
<head>
<title>Satomi Shigemori - Sexy Asian Bikini Model | Shareapic.net</title>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<META NAME="Abstract" CONTENT="Satomi Shigemori - Sexy Asian Bikini Model">
<META NAME="Author" CONTENT="Shareapic.net">
<META NAME="Copyright" CONTENT="2006-2009 Shareapic.net">
<META NAME="Description" CONTENT="Satomi Shigemori - Sexy Asian Bikini Model">
<META NAME="Language" CONTENT="EN">
<META NAME="Keywords" CONTENT="image hosting, free image hosting, photo hosting site, image hosting site, image hosting for myspace, image hosting for ebay, image hosting for forums, hosting, image, photo site, photo album">
<META NAME="Robots" CONTENT="index,nofollow">


<style type="text/css">
@import url(contentcss.php);

</style>

<!--  Rubicon Project Tag -->
<!--  Site: Shareapic   Zone: My Site   Size: Pop  -->
<script language="JavaScript" type="text/javascript">
var cb = Math.random();
var d = document;
var ref = "";
try {
    if ((window != top) && (window.parent == top)) {
        ref = "&rf="+escape(d.referrer);
    }
} catch (ignore) { }
d.write('<script language="JavaScript" type="text/javascript"');
d.write('src="http://optimized-by.rubiconproject.com/a/7081/11403/18849-20.js?cb='+cb+ref+'">');
d.write('<\/scr'+'ipt>');
</script>
<noscript>
<a href="http://optimized-by.rubiconproject.com/t/7081/11403/18849-20.1"><img src="http://optimized-by.rubiconproject.com/a/7081/11403/18849-20.img" width="Pop" height="" border="0"></a>
</noscript>


</head>
<body onload="breakout_of_frame()">
<table width="100%" border="0" cellspacing="0" cellpadding="0" background="http://www.shareapic.net/bg.gif">
<tr>
<td width="20%"><div align="center"><a href="http://www.shareapic.net"><img src="http://www.shareapic.net/logo.png" border="0" height="100" /></a></div></td>
<td width="75%" style="padding:5px;"><div align="center">

<!--  Rubicon Project Tag -->
<!--  Site: Shareapic   Zone: My Site   Size: Leaderboard  -->
<script language="JavaScript" type="text/javascript">
var cb = Math.random();
var d = document;
var ref = "";
try {
    if ((window != top) && (window.parent == top)) {
        ref = "&rf="+escape(d.referrer);
    }
} catch (ignore) { }
d.write('<script language="JavaScript" type="text/javascript"');
d.write('src="http://optimized-by.rubiconproject.com/a/7081/11403/18849-2.js?cb='+cb+ref+'">');
d.write('<\/scr'+'ipt>');
</script>
<noscript>
<a href="http://optimized-by.rubiconproject.com/t/7081/11403/18849-2.1"><img src="http://optimized-by.rubiconproject.com/a/7081/11403/18849-2.img" width="728" height="90" border="0"></a>
</noscript>
</div></td>
</tr>
</table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td><img src="http://www.shareapic.net/util_history-t_2x4.gif" height="2px" width="100%" /></td>
</tr>
</table>
<table width="950px" border="0" cellspacing="0" cellpadding="7" align="center">
  <tr>

    <td width="800px" bgcolor="#FFFFFF"><div align="center"><div id="nav">
    <a href="http://www.shareapic.net/index.php" class="menu" target="_self">Home</a>
    <a href="http://www.shareapic.net/public-galleries/0/" class="menu" target="_self">Public Galleries</a>
    <a href="http://www.shareapic.net/main.php" class="menu" target="_self">Members Area</a>
    <a href="http://www.shareapic.net/signup/signup.php" class="menu" target="_self">SIGN UP!</a>
    <a href="http://www.shareapic.net/search.php" class="menu" target="_self">Search <img border="0" src="icon_new_26x11.gif" /></a>

    <a href="http://shareapic.zendesk.com/" class="menu" target="_blank">Support</a>
    <a href="http://www.twitter.com/shareapic" class="menu" target="_blank">Twitter</a></div></div></td>
    </td>
  </tr>
</table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" style="padding-bottom:2px;">
<tr>
<td><img src="http://www.shareapic.net/dropshadow.gif" height="13px" width="100%" /></td>
</tr>
</table><div style="padding:5px;"></div>
<table width="1100" border="0" cellspacing="0" cellpadding="0" align="center">

<tr>
<td width="90%"><table width="100%" border="0" cellpadding="0">
<tr>
<td align="left"><h1 style="text-transform: capitalize; letter-spacing: -1px; font-weight: normal; font-size: 28px; line-height: normal; color:#444; font-family: Optima,Segoe,'Segoe UI',Candara,Calibri,Arial,sans-serif;">Satomi Shigemori - Sexy Asian Bikini Model</h1></td>
<td align="right" width="175">

<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a href="http://www.addthis.com/bookmark.php?v=250&amp;username=shareapic" class="addthis_button_compact" addthis:title="View Satomi Shigemori - Sexy Asian Bikini Model on Shareapic.net">Share</a>
<span class="addthis_separator">|</span>
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>

</div>
<!-- AddThis Button END -->

</td>
<td align="center" width="100">
<div style="width:100px;"><a style="color:#be0000; font-weight:bold; font-size:11px;" href="http://www.shareapic.net/dmca.html">Report Copyright Infringement</a></span>
</td>
</tr>
</table>
<hr size="1" color="CCCCCC"/></td>
</tr>
</table>

<center>
<table width="800" border="0" cellspacing="0" cellpadding="0">
<tr>

<td width="300" valign="top" style="padding: 0 10px 0 0;"><div align="center">



<div class="blue_fbox_content" align="center" style="padding:0; margin-top:10px;">
<div style="padding:8px;"></div>
<table>
<tr><td align="center">
<div class="prevNextThumbsHolder">
<div class="border">
<div class="prevNextThumbs">
<a href="http://www.shareapic.net/View-24384248-Satomi-Shigemori---Sexy-Asian-Bikini-Model.html"><img style="margin: -37.5px 0pt 0pt -50px;" title="" src="
http://preview.shareapic.net/preview7/024384248.jpg
"></a>
</div>
</div>
<div style="margin-top:10px;"><a style="font-size:1.13em; font-weight:bold;" href="http://www.shareapic.net/View-24384248-Satomi-Shigemori---Sexy-Asian-Bikini-Model.html" rel="prev" title="previous picture">&laquo; prev</a></div>

</div>
</td>
<td align="center">
<div class="prevNextThumbsHolder">
<div class="border">
<div class="prevNextThumbs">
<a href="http://www.shareapic.net/View-24384252-Satomi-Shigemori---Sexy-Asian-Bikini-Model.html"><img style="margin: -35.5px 0pt 0pt -50px;" title="" src="
http://preview.shareapic.net/preview7/024384252.jpg
"></a>
</div>
</div>
<div style="margin-top:10px;"><a style="font-size:1.13em; font-weight:bold;" href="http://www.shareapic.net/View-24384252-Satomi-Shigemori---Sexy-Asian-Bikini-Model.html" rel="next" title="next picture">next &raquo;</a></div>
</div>
</td>
</tr>
</table>
<div style="padding:8px;"></div>

</div>

<!--  Rubicon Project Tag -->
<!--  Site: Shareapic   Zone: My Site   Size: Medium Rectangle  -->
<script language="JavaScript" type="text/javascript">
var cb = Math.random();
var d = document;
var ref = "";
try {
    if ((window != top) && (window.parent == top)) {
        ref = "&rf="+escape(d.referrer);
    }
} catch (ignore) { }
d.write('<script language="JavaScript" type="text/javascript"');
d.write('src="http://optimized-by.rubiconproject.com/a/7081/11403/18849-15.js?cb='+cb+ref+'">');
d.write('<\/scr'+'ipt>');
</script>
<noscript>
<a href="http://optimized-by.rubiconproject.com/t/7081/11403/18849-15.1"><img src="http://optimized-by.rubiconproject.com/a/7081/11403/18849-15.img" width="300" height="250" border="0"></a>
</noscript>

<div style="padding:3px;"></div>

<div style="padding:3px;"></div>
</td>
<td width="470" valign="top"><div align="center" style="padding:0 0 0 10px;">
<p></p>

<table cellspacing="0" cellpadding="0 10px 0 10px" width="300px" align="center"><tr><td align="center" valign="top">

<div style="position: relative;
   height: 45px;">
   
<a href="http://www.bobagames.com" target="_blank" style="color:fff;">
<div align="left" style="position:absolute; width:200px;left: 0;">
<div style="margin: 0 7px 4px 4px; display: block; background: none repeat scroll 0% 0% #e2018d; float: left; color: #fff; padding: 7px 5px; font-size: 11px; -moz-border-radius: 3px 3px 3px 3px;"><span><center><b>Want <br>Games?</b></center></span></div>
<div style="padding: 6px;font-size: 11px;margin-left:4px;">
Play Lots of Fun, Free<br>Games on BobaGames!
</div>
</div>
</a>

<div align="right" style="position:absolute; width:450px;right: 0;">
<p style="font-size:11px;font-family:Arial, Helvetica, sans-serif;font-weight:bold;" align="right">

<a href="http://www.shareapic.net/users/cubbies7/" class="small orange awesome" style="color:#ffffff;margin-left:5px;">More from cubbies7</a> <a href="http://www.shareapic.net/Zoom-24384249-Satomi-Shigemori---Sexy-Asian-Bikini-Model.html" target='blank' class="small blue awesome" style="color:#ffffff;margin-left:5px;">Zoom In</a> <a href="http://www.shareapic.net/898538-Satomi-Shigemori---Sexy-Asian-Bikini-Model.html" class="small green awesome" style="color:#ffffff;margin-left:5px;">Full Album</a> <a href="http://www.shareapic.net/content3.php?id=24384249" class="small magenta awesome" style="color:#ffffff;margin-left:5px;">Link To It</a> 
</p>
</div>

</div>



<div id="bannerad" style="padding-top:10px;">

<a href="http://www.shareapic.net/View-24384252-Satomi-Shigemori---Sexy-Asian-Bikini-Model.html">

<img src="http://images.shareapic.net/images7/024384249.jpg" alt="Satomi Shigemori - Sexy Asian Bikini Model" border="0"  />

</a>


</div>

<div style="padding:10px;"></div>

<div align="center" style="width:616px;">



<!--  Rubicon Project Tag -->

<!--  Site: Shareapic   Zone: My Site   Size: Banner  -->
<script language="JavaScript" type="text/javascript">
var cb = Math.random();
var d = document;
var ref = "";
try {
    if ((window != top) && (window.parent == top)) {
        ref = "&rf="+escape(d.referrer);
    }
} catch (ignore) { }
d.write('<script language="JavaScript" type="text/javascript"');
d.write('src="http://optimized-by.rubiconproject.com/a/7081/11403/18849-1.js?cb='+cb+ref+'">');
d.write('<\/scr'+'ipt>');
</script>
<noscript>
<a href="http://optimized-by.rubiconproject.com/t/7081/11403/18849-1.1"><img src="http://optimized-by.rubiconproject.com/a/7081/11403/18849-1.img" width="468" height="60" border="0"></a>
</noscript>

</div>


</td>
<td width="160px" valign="top" align="right" style="padding: 0 0 0 10px;">

<center>

<div align="left" style="padding-left:12px;"><h1 style="text-transform: lowercase; letter-spacing:normal; font-weight:normal; color:#999; font-size:24px; font-family:Baskerville,'Palatino Linotype',Palatino,Georgia,serif; font-style:italic;">You might like:</h1></div>

<IFRAME FRAMEBORDER=0 MARGINWIDTH=0 MARGINHEIGHT=0 SCROLLING=NO WIDTH=130 HEIGHT=190 SRC="http://www.shareapic.net/morefrom.php?user=12306"></IFRAME>


<div style="padding:0 0 0 20px;">


<!--  Rubicon Project Tag -->
<!--  Site: Shareapic   Zone: My Site   Size: Wide Skyscraper  -->
<script language="JavaScript" type="text/javascript">
var cb = Math.random();
var d = document;
var ref = "";
try {
    if ((window != top) && (window.parent == top)) {
        ref = "&rf="+escape(d.referrer);
    }
} catch (ignore) { }
d.write('<script language="JavaScript" type="text/javascript"');
d.write('src="http://optimized-by.rubiconproject.com/a/7081/11403/18849-9.js?cb='+cb+ref+'">');
d.write('<\/scr'+'ipt>');
</script>
<noscript>
<a href="http://optimized-by.rubiconproject.com/t/7081/11403/18849-9.1"><img src="http://optimized-by.rubiconproject.com/a/7081/11403/18849-9.img" width="160" height="600" border="0"></a>
</noscript>

</div>

</center>

<div style="padding:10px;"></div>

</td>
</tr>

</table>
<p align="center"></div>
<table width="100%" border="0" cellspacing="0" cellpadding="10">
<tr>
<td align="center"></td>
</tr>
<tr>  </tr>
</table>
<div align="center"></p>
</td>

</tr>
</table></td></tr>


<!-- AddThis Code BEGIN -->
<script type="text/javascript">var addthis_config = {"data_track_clickback":true};</script>
<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#username=shareapic"></script>
<!-- AddThis Code END -->

<table width="100%" height="50" border="0" cellspacing="0" cellpadding="5">
        <tr>
          <td bgcolor="#FFFFFF" style="padding-left:10px;"><span class="style5">&copy; Shareapic.net - All Rights Reserved - <a href="http://www.shareapic.net/index.php" class="foot">Home</a> | 

<a href="http://www.shareapic.net/privacy.php" class="foot">Privacy Policy</a> |
<a href="http://www.shareapic.net/terms.php" class="foot">Terms of Service</a> |
<a href="http://www.shareapic.net/faq.php" class="foot">FAQ's</a> |
<a href="http://www.shareapic.net/contact.php" class="foot">Contact Us</a> |
<a href="http://www.shareapic.net/advertising.php" class="foot">Advertise</a> |
<a href="http://www.echelondesignstudio.com/" class="foot" target="_blank">Website Design</a> |

<a href="http://www.orlandoattorney1.com" class="foot" target="_blank">Orlando Attorney</a>
</span></td>
<td bgcolor="#FFFFFF"><div align="right"><img src="http://www.shareapic.net/footer.gif" width="139" height="50" /></div></td>
        </tr>
</table>
<table align="center" width="100%" height="5" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td background="spacer1.gif" height="2px"><img src="http://www.shareapic.net/spacer1.gif" width="100%" height="2px"/></td>
  </tr>
</table>
</td>
  </tr>

</table>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-467328-3";
urchinTracker();
</script>
</body>
</html>"""
        self.shpic = shareapic.ShareapicParse(self.url, self.basedir)

    def test_process_url(self):
        self.page = self.shpic.process_url(self.url)
        self.assertIsInstance(self.page, lxml.html.HtmlElement)

    def test_shareapic_get_image_src(self):
        self.shareapic_src = self.shpic.shareapic_get_image_src(lxml.html.fromstring(self.example_shpic_page))
        self.assertIsInstance(self.shareapic_src, list)
        self.assertTrue(self.shareapic_src[0])

    def test_shareapic_save_image(self):
        #TODO: how to test this?
        pass


def main():
    suite = unittest.TestLoader().loadTestsFromTestCase(TestShareapic)
    unittest.TextTestRunner(verbosity=2).run(suite)

main()
